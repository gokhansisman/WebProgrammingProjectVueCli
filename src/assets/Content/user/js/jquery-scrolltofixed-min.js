!function(a){a.isScrollToFixed=function(b){return void 0!==a(b).data("ScrollToFixed")},a.ScrollToFixed=function(b,c){function n(){f.trigger("preUnfixed"),u(),f.trigger("unfixed"),k=-1,h=f.offset().top,i=f.offset().left,d.options.offsets&&(i+=f.offset().left-f.position().left),j==-1&&(j=i),g=f.css("position"),e=!0,d.options.bottom!=-1&&(f.trigger("preFixed"),s(),f.trigger("fixed"))}function o(){var a=d.options.limit;return a?"function"==typeof a?a():a:0}function p(){return"fixed"===g}function q(){return"absolute"===g}function r(){return!(p()||q())}function s(){p()||(l.css({display:f.css("display"),width:f.outerWidth(!0),height:f.outerHeight(!0),float:f.css("float")}),f.css({width:f.width(),position:"fixed","background-color":"White","padding-bottom":"10px","border-top":"3px solid #febf00",top:d.options.bottom==-1?w():"",bottom:d.options.bottom==-1?"":d.options.bottom}),g="fixed")}function t(){f.css({width:f.width(),position:"absolute",top:o(),left:i}),g="absolute"}function u(){r()||(k=-1,l.css("display","none"),f.css({width:"",position:"",left:"",top:"","padding-bottom":"","background-color":"","border-top":""}),g=null)}function v(a){a!=k&&(f.css("left",i-a),k=a)}function w(){return d.options.marginTop}function x(){if(a.isScrollToFixed(f)){var b=e;e||n();var c=a(window).scrollLeft(),g=a(window).scrollTop(),i=o();d.options.minWidth&&a(window).width()<d.options.minWidth?r()&&b||(y(),f.trigger("preUnfixed"),u(),f.trigger("unfixed")):d.options.bottom==-1?i>0&&g>=i-w()?q()&&b||(y(),f.trigger("preAbsolute"),t(),f.trigger("unfixed")):g>=h-w()?(p()&&b||(y(),f.trigger("preFixed"),s(),k=-1,f.trigger("fixed")),v(c)):r()&&b||(y(),f.trigger("preUnfixed"),u(),f.trigger("unfixed")):i>0?g+a(window).height()-f.outerHeight(!0)>=i-w()?p()&&(y(),f.trigger("preUnfixed"),u(),f.trigger("unfixed")):(p()||(y(),f.trigger("preFixed"),s()),v(c),f.trigger("fixed")):v(c)}}function y(){var a=f.css("position");"absolute"==a?f.trigger("postAbsolute"):"fixed"==a?f.trigger("postFixed"):f.trigger("postUnfixed")}var d=this;d.$el=a(b),d.el=b,d.$el.data("ScrollToFixed",d);var g,e=!1,f=d.$el,h=0,i=0,j=-1,k=-1,l=null,z=function(a){f.is(":visible")&&(e=!1,x())},A=function(a){x()};d.init=function(){d.options=a.extend({},a.ScrollToFixed.defaultOptions,c),("iPad"!==navigator.platform&&"iPhone"!==navigator.platform&&"iPod"!==navigator.platform||navigator.userAgent.match(/OS 5_.*\ like Mac OS X/i))&&(d.$el.css("z-index",d.options.zIndex),l=a("<div />"),g=f.css("position"),r()&&d.$el.after(l),a(window).bind("resize.ScrollToFixed",z),a(window).bind("scroll.ScrollToFixed",A),d.options.preFixed&&f.bind("preFixed.ScrollToFixed",d.options.preFixed),d.options.postFixed&&f.bind("postFixed.ScrollToFixed",d.options.postFixed),d.options.preUnfixed&&f.bind("preUnfixed.ScrollToFixed",d.options.preUnfixed),d.options.postUnfixed&&f.bind("postUnfixed.ScrollToFixed",d.options.postUnfixed),d.options.preAbsolute&&f.bind("preAbsolute.ScrollToFixed",d.options.preAbsolute),d.options.postAbsolute&&f.bind("postAbsolute.ScrollToFixed",d.options.postAbsolute),d.options.fixed&&f.bind("fixed.ScrollToFixed",d.options.fixed),d.options.unfixed&&f.bind("unfixed.ScrollToFixed",d.options.unfixed),d.options.spacerClass&&l.addClass(d.options.spacerClass),f.bind("resize.ScrollToFixed",function(){l.height(f.height())}),f.bind("scroll.ScrollToFixed",function(){f.trigger("preUnfixed"),u(),f.trigger("unfixed"),x()}),f.bind("remove.ScrollToFixed",function(){f.trigger("preUnfixed"),u(),f.trigger("unfixed"),a(window).unbind("resize.ScrollToFixed",z),a(window).unbind("scroll.ScrollToFixed",A),f.unbind(".ScrollToFixed"),d.$el.removeData("ScrollToFixed")}),z())},d.init()},a.ScrollToFixed.defaultOptions={marginTop:0,limit:0,bottom:-1,zIndex:999999999},a.fn.scrollToFixed=function(b){return this.each(function(){new a.ScrollToFixed(this,b)})}}(jQuery);